---
import type { ImageMetadata } from 'astro'
import { Image } from 'astro:assets'
import type { CollectionEntry } from 'astro:content'
import Badge from './Badge.astro'
import WorldMap from '@/assets/icons/WorldMap.astro'
import GitHub from '@/assets/icons/GitHub.astro'
export interface Props {
  project: CollectionEntry<"projects">
}

const { project } = Astro.props
const { Content } = await project.render()
const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/project-images/*.png')

if(!images[project.data.image]) {
    throw new Error(`Image ${project.data.image} not found`)
}
---
<article class="project-card">
    <Image
        class='project-image'
        width={300}
        height={300}
        src={images[project.data.image]()}
        alt={project.data.title + "project"}
    />
    <div class="details-container">
        <h3>{project.data.title}</h3>
        {
            project.data.technologies.map((tech, index) => {
                return <Badge text={tech} />
            })
        }
        <p>
            <Content/>
        </p>
        <ul class="project-links">
            <li><a target="_blank" aria-label={project.data.title + ' demo'} href={project.data.demoUrl}><WorldMap width={24} height={24}/></a></li>
            <li><a target="_blank" aria-label={project.data.title + ' source code'} href={project.data.githubUrl}><GitHub width={24} height={24}/></a></li>
        </ul>
    </div>
</article>

<style>
    .project-card {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-shadow: 0.3rem 0.5rem 0.9rem rgba(0, 0, 0, 0.2);
        border-bottom: 12px solid var(--main-color);
    }

    img {
        border-radius: 0.5rem 0.5rem 0 0;
    }

    .details-container {
        position: relative;
        padding: 1rem 2.0rem; 
    }

    .project-links {
        color: var(--secondary-font-color);
        display: flex;
        gap: 1.4rem;
        list-style: none;
        justify-content: end;
    }

    a:hover {
        color: var(--main-color);
    }
    h3 {
        margin-bottom: 0.5rem;
    }

    p {
        margin-bottom: 1rem;
    }

    @media (min-width: 768px) {
        .project-card {
            flex-direction: row;
            border-bottom: none;
            border-right: 12px solid var(--main-color);
            gap: 3rem;
        }
        img {
            border-radius: 0.5rem 0 0 0.5rem;
        }

        .details-container {
            padding: 2rem 2.0rem 0 0; 
        }

        .project-links {
            position: absolute;
            padding: 2rem 2.5rem;
            width: 100%;
            top: 0;
            right: 0;
        }
    }
</style>